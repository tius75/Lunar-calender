<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalender Lunar & Ramalan Lengkap 2576</title>
    <style>
        :root {
            --merah-tua: #8b0000;
            --merah-terang: #d32f2f;
            --emas: #d4af37;
            --krem: #fcf4dd;
            --putih: #ffffff;
            --hijau-wa: #25D366;
        }

        body { font-family: 'Segoe UI', sans-serif; background-color: #f5f5f5; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .app-container { width: 100%; max-width: 480px; background: var(--putih); border: 3px solid var(--emas); border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; }

        .search-bar { background: var(--krem); padding: 15px; display: flex; gap: 8px; border-bottom: 2px solid var(--emas); }
        .search-bar input { flex: 1; padding: 10px; border: 1px solid var(--emas); border-radius: 8px; }
        .btn-cari { background: var(--merah-tua); color: var(--emas); border: none; padding: 0 15px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        
        .calendar-header { background: var(--merah-tua); color: var(--emas); padding: 15px; text-align: center; }
        .header-nav { display: flex; justify-content: space-between; margin-top: 10px; }
        .btn-nav { background: var(--emas); color: var(--merah-tua); border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }

        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); background: var(--krem); }
        .label-hari { background: var(--merah-terang); color: var(--putih); padding: 10px 0; text-align: center; font-size: 0.8rem; font-weight: bold; }
        .sel-tanggal { aspect-ratio: 1/1.2; border: 0.1px solid rgba(212, 175, 55, 0.2); display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; background: white; }
        .sel-tanggal.hari-ini { background: var(--merah-terang); color: var(--emas); }
        .sel-tanggal.pilihan { border: 2px solid var(--merah-tua); background: #ffebeb; }

        #panelDetail { padding: 15px; background: var(--putih); border-top: 3px solid var(--emas); display: none; }
        .kartu-info { background: var(--krem); padding: 15px; border-radius: 10px; border-left: 5px solid var(--merah-tua); }
        
        .grid-detail { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .item-detail { background: white; padding: 8px; border-radius: 8px; border: 1px solid #eee; }
        .label-kecil { font-size: 0.7rem; color: #888; display: block; }
        .isi-detail { font-size: 0.85rem; font-weight: bold; color: #333; }

        .section-box { margin-top: 12px; padding: 10px; background: #fff; border-radius: 8px; border: 1px dashed var(--emas); font-size: 0.85rem; }
        .box-title { font-weight: bold; color: var(--merah-tua); border-bottom: 1px solid #eee; margin-bottom: 5px; display: block; }

        .btn-wa { width: 100%; background-color: var(--hijau-wa); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: bold; margin-top: 15px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
    </style>
</head>
<body>

    <div class="app-container">
        <div class="search-bar">
            <input type="date" id="inputCari">
            <button class="btn-cari" id="btnCari">CARI</button>
        </div>

        <div class="calendar-header">
            <h2 id="judulBulan" style="margin:0">Januari 2026</h2>
            <div class="header-nav">
                <button class="btn-nav" id="btnPrev">Sebelumnya</button>
                <button class="btn-nav" id="btnNext">Berikutnya</button>
            </div>
        </div>

        <div class="calendar-grid" id="grid"></div>

        <div id="panelDetail">
            <div class="kartu-info">
                <h3 id="shioUtama" style="margin:0; color: var(--merah-tua);"></h3>
                <div id="elemenBadge" style="font-weight: bold; color: var(--merah-terang); font-size: 0.9rem;"></div>
                
                <div id="tglMasehi" style="font-weight: bold; margin-top: 10px;"></div>
                <div id="tglLunarNumerik" style="color: var(--merah-tua); font-weight: bold; font-size: 1.1rem;"></div>

                <div class="grid-detail">
                    <div class="item-detail"><span class="label-kecil">Batang Langit</span><span class="isi-detail" id="btgLangit"></span></div>
                    <div class="item-detail"><span class="label-kecil">Cabang Bumi</span><span class="isi-detail" id="cbgBumi"></span></div>
                    <div class="item-detail"><span class="label-kecil">Arah Rejeki</span><span class="isi-detail" id="arahRejeki">Barat Daya</span></div>
                    <div class="item-detail"><span class="label-kecil">Zodiak</span><span class="isi-detail" id="zodiakDisplay"></span></div>
                </div>

                <div class="section-box">
                    <span class="box-title">ðŸŒŸ Ramalan Zodiak</span>
                    <div id="teksZodiak"></div>
                </div>

                <div class="section-box" style="background: #fff9e6;">
                    <span class="box-title">ðŸ’ž Pasangan Shio Serasi (Jodoh)</span>
                    <div id="teksJodoh"></div>
                </div>

                <div class="section-box">
                    <span class="box-title">ðŸ“… Sembahyang & Peruntungan</span>
                    <div id="teksRamalan"></div>
                </div>

                <button class="btn-wa" id="btnWhatsApp">ðŸ“± Bagikan ke WhatsApp</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { Solar, Lunar } from 'https://esm.run/lunar-javascript';

        let viewDate = new Date();
        const daftarBulan = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];

        // KAMUS TERJEMAHAN
        const kamusShio = { "Rat": "Tikus", "Ox": "Kerbau", "Tiger": "Macan", "Rabbit": "Kelinci", "Dragon": "Naga", "Snake": "Ular", "Horse": "Kuda", "Goat": "Kambing", "Monkey": "Monyet", "Rooster": "Ayam", "Dog": "Anjing", "Pig": "Babi" };
        const kamusBatang = { "ç”²": "Kayu Yang", "ä¹™": "Kayu Yin", "ä¸™": "Api Yang", "ä¸": "Api Yin", "æˆŠ": "Tanah Yang", "å·±": "Tanah Yin", "åºš": "Logam Yang", "è¾›": "Logam Yin", "å£¬": "Air Yang", "ç™¸": "Air Yin" };
        const kamusCabang = { "å­": "Tikus (Air)", "ä¸‘": "Kerbau (Tanah)", "å¯…": "Macan (Kayu)", "å¯": "Kelinci (Kayu)", "è¾°": "Naga (Tanah)", "å·³": "Ular (Api)", "åˆ": "Kuda (Api)", "æœª": "Kambing (Tanah)", "ç”³": "Monyet (Logam)", "é…‰": "Ayam (Logam)", "æˆŒ": "Anjing (Tanah)", "äº¥": "Babi (Air)" };
        const kamusZodiak = { "æ°´ç“¶": "Aquarius", "åŒé±¼": "Pisces", "ç™½ç¾Š": "Aries", "é‡‘ç‰›": "Taurus", "åŒå­": "Gemini", "å·¨èŸ¹": "Cancer", "ç‹®å­": "Leo", "å¤„å¥³": "Virgo", "å¤©ç§¤": "Libra", "å¤©èŽ": "Scorpio", "å°„æ‰‹": "Sagitarius", "æ‘©ç¾¯": "Capricorn" };
        const jodohShio = { "Tikus": "Naga, Monyet", "Kerbau": "Tikus, Ayam", "Macan": "Kuda, Anjing", "Kelinci": "Kambing, Babi", "Naga": "Tikus, Monyet", "Ular": "Kerbau, Ayam", "Kuda": "Macan, Anjing", "Kambing": "Kelinci, Babi", "Monyet": "Tikus, Naga", "Ayam": "Kerbau, Ular", "Anjing": "Macan, Kuda", "Babi": "Kelinci, Kambing" };

        function renderCalendar(tgl, targetDay = null) {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            const y = tgl.getFullYear(), m = tgl.getMonth();
            document.getElementById('judulBulan').innerText = `${daftarBulan[m]} ${y}`;

            ["Min", "Sen", "Sel", "Rab", "Kam", "Jum", "Sab"].forEach(h => grid.innerHTML += `<div class="label-hari">${h}</div>`);

            const firstDay = new Date(y, m, 1).getDay();
            const daysInMonth = new Date(y, m + 1, 0).getDate();

            for (let i = 0; i < firstDay; i++) grid.innerHTML += `<div></div>`;

            for (let d = 1; d <= daysInMonth; d++) {
                const s = Solar.fromYmd(y, m + 1, d);
                const l = s.getLunar();
                const isToday = new Date().toDateString() === new Date(y, m, d).toDateString();
                const isTarget = targetDay === d;

                const sel = document.createElement('div');
                sel.className = `sel-tanggal ${isToday ? 'hari-ini' : ''} ${isTarget ? 'pilihan' : ''}`;
                sel.innerHTML = `<span class="tgl-masehi">${d}</span><span style="font-size:0.6rem; color:red;">${l.getDayInChinese()}</span>`;
                sel.onclick = () => showDetail(s, l);
                grid.appendChild(sel);
                if (isTarget || (targetDay === null && isToday)) showDetail(s, l);
            }
        }

        function showDetail(solar, lunar) {
            document.getElementById('panelDetail').style.display = 'block';
            
            // Logika Penentuan Shio (Mencegah Undefined)
            const shioAsli = lunar.getYearShengXiao();
            const shioIndo = kamusShio[shioAsli] || shioAsli;
            
            const tahunK = lunar.getYear() + 551;
            const tglL = `${lunar.getDay()} - ${lunar.getMonth()} - ${tahunK}`;
            const zodiak = kamusZodiak[solar.getXingZuo()] || solar.getXingZuo();
            const elemen = lunar.getYearNaYin();
            const btg = kamusBatang[lunar.getYearGan()] || lunar.getYearGan();
            const cbg = kamusCabang[lunar.getYearZhi()] || lunar.getYearZhi();
            const arah = "Barat Daya";

            document.getElementById('shioUtama').innerText = `Shio ${shioIndo}`;
            document.getElementById('elemenBadge').innerText = `Elemen: ${elemen}`;
            document.getElementById('tglMasehi').innerText = `${solar.getDay()} ${daftarBulan[solar.getMonth()-1]} ${solar.getYear()}`;
            document.getElementById('tglLunarNumerik').innerText = `Lunar: ${tglL}`;
            document.getElementById('btgLangit').innerText = btg;
            document.getElementById('cbgBumi').innerText = cbg;
            document.getElementById('zodiakDisplay').innerText = zodiak;
            document.getElementById('arahRejeki').innerText = arah;

            // Konten Ramalan
            const teksZod = `Hari ini ${zodiak} sebaiknya lebih teliti dalam urusan pekerjaan dan keuangan.`;
            const teksJod = `Pasangan paling cocok untuk Shio ${shioIndo} adalah ${jodohShio[shioIndo] || "N/A"}.`;
            let sembahyang = "Jadwal rutin harian.";
            if (lunar.getDay() === 1) sembahyang = "Sembahyang Ce It (Awal Bulan)";
            if (lunar.getDay() === 15) sembahyang = "Sembahyang Cap Go (Purnama)";

            document.getElementById('teksZodiak').innerText = teksZod;
            document.getElementById('teksJodoh').innerText = teksJod;
            document.getElementById('teksRamalan').innerText = sembahyang;

            // Fitur WhatsApp Share (DIPERBAIKI)
            document.getElementById('btnWhatsApp').onclick = () => {
                const pesan = 
                    `ðŸ® *RAMALAN LUNAR HARIAN* ðŸ®%0A%0A` +
                    `ðŸ“… *Masehi:* ${solar.getDay()} ${daftarBulan[solar.getMonth()-1]} ${solar.getYear()}%0A` +
                    `ðŸŒ™ *Lunar:* ${tglL}%0A%0A` +
                    `ðŸ… *Shio:* ${shioIndo} (${elemen})%0A` +
                    `ðŸŒŒ *Zodiak:* ${zodiak}%0A` +
                    `ðŸ§­ *Arah Rejeki:* ${arah}%0A%0A` +
                    `---%0A%0A` +
                    `âœ¨ *Ramalan Zodiak:*%0A${teksZod}%0A%0A` +
                    `ðŸ’• *Jodoh Shio:*%0A${teksJod}%0A%0A` +
                    `ðŸ•¯ï¸ *Sembahyang:*%0A${sembahyang}%0A%0A` +
                    `---%0A%0A` +
                    `_Dikirim via: tius75.github.io/Lunar-calender/_`;
                
                window.open(`https://api.whatsapp.com/send?text=${pesan}`, '_blank');
            };

            document.getElementById('panelDetail').scrollIntoView({ behavior: 'smooth' });
        }

        document.getElementById('btnCari').onclick = () => {
            const val = document.getElementById('inputCari').value;
            if(!val) return;
            viewDate = new Date(val);
            renderCalendar(viewDate, viewDate.getDate());
        };

        document.getElementById('btnPrev').onclick = () => { viewDate.setMonth(viewDate.getMonth() - 1); renderCalendar(viewDate); };
        document.getElementById('btnNext').onclick = () => { viewDate.setMonth(viewDate.getMonth() + 1); renderCalendar(viewDate); };

        renderCalendar(viewDate);
    </script>
</body>
</html>
